---
title: "How to suppress package startup messages"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{How to suppress package startup messages}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

When making a reprex, you might need libraries that are producing some messages and warnings upon loading. The goal of this article is to suppress these, without suppressing all messages and warnings of the reprex, as they might be useful for debugging. This article aims at answering the issue [#187](https://github.com/tidyverse/reprex/issues/187). 

We review below the different possibilities to silence messages and warnings when loading a library. We use {dplyr} as an example.         

## Short version 

Messages and warnings can be suppressed by using the `warn.conflicts` and `quietly` arguments in `library()` or by using the `suppressPackageStartupMessages()` function.   

```{r, eval=FALSE}
library(dplyr, warn.conflicts = FALSE)
library(dplyr, quietly = TRUE)
suppressPackageStartupMessages(library(dplyr))
```

## Loading a library

Loading {dplyr} with `library(dplyr)` produces two warnings about conflicts. We would like to silence them.       

```{r}
# Loading dplyr
library(dplyr)
```
    

## Loading a library without warnings

To suppress the warnings about conflicts, you can set the `warn.conflicts` argument to `FALSE` in `library()`. As written in the documentation of the `library()` function, a conflict is a function masking a function, or a non-function masking a non-function. Note that this also silences the line `Attaching package: ‘dplyr’`.     

```{r}
# Detaching dplyr (loaded in the chunk above)
detach("package:dplyr", unload=TRUE)
# Loading dplyr
library(dplyr, warn.conflicts = FALSE)
```


## Loading a library without messages

To suppress some of the startup messages, you can also set the `quietly` argument in the `library()` function to `TRUE`. This does not suppress the warnings about conflicts. Also note that here the line `Attaching package: ‘dplyr’` is not affected by `quietly`.

```{r}
# Detaching dplyr (loaded in the chunk above)
detach("package:dplyr", unload=TRUE)
# Loading dplyr
library(dplyr, quietly = TRUE)
```


## Loading a library silently with the function suppressPackageStartupMessages()

`suppressPackageStartupMessages()` ignores diagnostic messages when loading a package. It also ignores warnings about conflicts. Here it suppresses all messages and warnings. 
```{r}
# Detaching dplyr (loaded in the chunk above)
detach("package:dplyr", unload=TRUE)
# Loading dplyr
suppressPackageStartupMessages(library(dplyr))
```


## Loading a library silently within a chunk

Another way to silence the warnings and messages is to set the chunk options `message` and `warning` to `FALSE`. To prevent hiding useful warnings and messages for debugging a reprex, separate the chunk loading the librairies from the rest of the reprex. 

Within an Rmarkdown document that you `knit`:

````r
`r ''````{r chunk1, message=FALSE, warning=FALSE}  
library(dplyr)  
```
Some text
`r ''````{r chunk2, message=TRUE, warning=TRUE}     
# reprex code goes here ... 
```
````

or within an R script that you `spin`: 

```{r}
#+ message = FALSE, warning = FALSE
library(dplyr)

#+ reprex-body
# reprex code goes here ...
```


## Loading the tidyverse library silently

In the function `reprex()` from {reprex}, the argument `tidyverse.quiet` (set to `TRUE` by default) suppresses the startup messages for the {tidyverse} package. 

```{r, eval=FALSE}
# Loading reprex
library(reprex)

# Creating a reprex
ret <- reprex({
library(tidyverse)
a <- 1:5
tibble(a, a * 2)
}, 
tidyverse_quiet = TRUE)
```


